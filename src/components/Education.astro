---
const didYouKnow = {
    id: [
        "Gamelan Jawa menggunakan sistem nada pentatonik yang berbeda dari musik Barat",
        "Wayang Kulit diiringi oleh dalang yang bisa bercerita hingga 9 jam tanpa henti",
        "Rumah adat Tongkonan Toraja menghadap utara sebagai simbol hubungan dengan leluhur",
    ],
    en: [
        "Javanese Gamelan uses a pentatonic scale system different from Western music",
        "Wayang Kulit is accompanied by a dalang who can narrate for up to 9 hours non-stop",
        "Toraja's Tongkonan house faces north as a symbol of connection with ancestors",
    ],
};
---

<section class="education section" id="education">
    <div class="container">
        <!-- Did You Know Section -->
        <div class="education__know fade-up">
            <div class="education__know-header">
                <span class="education__know-icon"></span>
                <h3 class="education__know-title" id="know-title">
                    Tahukah Kamu?
                </h3>
            </div>
            <div class="education__know-content" id="know-content">
                <p class="education__know-text" id="know-text"></p>
            </div>
        </div>
    </div>
</section>

<!-- Know Data for JS -->
<script define:vars={{ didYouKnow }}>
    window.didYouKnowData = didYouKnow;
</script>

<style>
    .education {
        background-color: var(--charcoal);
        color: var(--warm-white);
    }

    /* Did You Know - simplified for standalone */
    .education__know {
        background: transparent;
        padding: var(--space-xl) 0;
        max-width: 800px;
        margin: 0 auto;
    }

    .education__know-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-lg);
    }

    .education__know-header {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-md);
        margin-bottom: var(--space-xl);
    }

    .education__know-icon {
        font-size: 2.5rem;
    }

    .education__know-title {
        font-size: var(--text-2xl);
        color: var(--warm-white);
        margin: 0;
    }

    .education__know-text {
        font-size: var(--text-lg);
        line-height: 1.8;
        color: rgba(250, 247, 242, 0.9);
        min-height: 60px;
        text-align: center;
    }

    .education__know-btn {
        border-color: rgba(250, 247, 242, 0.3);
        color: var(--warm-white);
    }

    .education__know-btn:hover {
        background-color: var(--terracotta);
        border-color: var(--terracotta);
    }
</style>

<script>
    import gsap from "gsap";

    const didYouKnowData = (window as any).didYouKnowData;
    const knowText = document.getElementById("know-text");
    const knowTitle = document.getElementById("know-title");
    const knowBtnText = document.getElementById("know-btn-text");

    let currentFactIndex = 0;
    let currentLang = localStorage.getItem("lang") || "en";

    function showFact() {
        const facts = didYouKnowData[currentLang];
        if (!knowText || !facts) return;

        gsap.to(knowText, {
            opacity: 0,
            y: -10,
            duration: 0.2,
            onComplete: () => {
                knowText.textContent = facts[currentFactIndex];
                gsap.to(knowText, {
                    opacity: 1,
                    y: 0,
                    duration: 0.3,
                });
            },
        });
    }

    function nextFact() {
        const facts = didYouKnowData[currentLang];
        currentFactIndex = (currentFactIndex + 1) % facts.length;
        showFact();
    }

    // Initialize
    showFact();



    // Auto rotate every 8 seconds
    setInterval(nextFact, 8000);

    // Language change handler
    window.addEventListener("langchange", (e: CustomEvent) => {
        currentLang = e.detail.lang;
        currentFactIndex = 0;
        showFact();

        // Update title and button
        if (knowTitle) {
            knowTitle.textContent =
                currentLang === "id" ? "Tahukah Kamu?" : "Did You Know?";
        }
        if (knowBtnText) {
            knowBtnText.textContent =
                currentLang === "id" ? "Fakta Lainnya" : "Another Fact";
        }
    });
</script>
